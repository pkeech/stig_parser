<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?>
<Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:cpe="http://cpe.mitre.org/language/2.0"
    xmlns:xhtml="http://www.w3.org/1999/xhtml"
    xmlns:dc="http://purl.org/dc/elements/1.1/" id="Docker_Enterprise_2-x_Linux-UNIX_STIG" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd"
    xmlns="http://checklists.nist.gov/xccdf/1.1">
    <status date="2019-09-13">accepted</status>
    <title>Docker Enterprise 2.x Linux/UNIX Security Technical Implementation Guide</title>
    <description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description>
    <notice id="terms-of-use" xml:lang="en"></notice>
    <reference href="https://public.cyber.mil">
        <dc:publisher>DISA</dc:publisher>
        <dc:source>STIG.DOD.MIL</dc:source>
    </reference>
    <plain-text id="release-info">Release: 1 Benchmark Date: 19 Jul 2019</plain-text>
    <version>1</version>
    <Profile id="MAC-1_Public">
        <title>I - Mission Critical Public</title>
        <description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description>
        <select idref="V-94863" selected="true" />
        <select idref="V-94865" selected="true" />
        <select idref="V-94867" selected="true" />
        <select idref="V-94869" selected="true" />
        <select idref="V-95111" selected="true" />
        <select idref="V-95113" selected="true" />
        <select idref="V-95355" selected="true" />
        <select idref="V-95357" selected="true" />
        <select idref="V-95599" selected="true" />
        <select idref="V-95601" selected="true" />
        <select idref="V-95603" selected="true" />
        <select idref="V-95605" selected="true" />
        <select idref="V-95607" selected="true" />
        <select idref="V-95609" selected="true" />
        <select idref="V-95611" selected="true" />
        <select idref="V-95613" selected="true" />
        <select idref="V-95615" selected="true" />
        <select idref="V-95617" selected="true" />
        <select idref="V-95619" selected="true" />
        <select idref="V-95621" selected="true" />
        <select idref="V-95623" selected="true" />
        <select idref="V-95625" selected="true" />
        <select idref="V-95627" selected="true" />
        <select idref="V-95629" selected="true" />
        <select idref="V-95631" selected="true" />
        <select idref="V-95635" selected="true" />
        <select idref="V-95637" selected="true" />
        <select idref="V-95639" selected="true" />
        <select idref="V-95641" selected="true" />
        <select idref="V-95643" selected="true" />
        <select idref="V-95645" selected="true" />
        <select idref="V-95647" selected="true" />
        <select idref="V-95649" selected="true" />
        <select idref="V-95651" selected="true" />
        <select idref="V-95653" selected="true" />
        <select idref="V-95655" selected="true" />
        <select idref="V-95657" selected="true" />
        <select idref="V-95659" selected="true" />
        <select idref="V-95661" selected="true" />
        <select idref="V-95663" selected="true" />
        <select idref="V-95665" selected="true" />
        <select idref="V-95667" selected="true" />
        <select idref="V-95669" selected="true" />
        <select idref="V-95671" selected="true" />
        <select idref="V-95673" selected="true" />
        <select idref="V-95675" selected="true" />
        <select idref="V-95677" selected="true" />
        <select idref="V-95679" selected="true" />
        <select idref="V-95681" selected="true" />
        <select idref="V-95683" selected="true" />
        <select idref="V-95685" selected="true" />
        <select idref="V-95687" selected="true" />
        <select idref="V-95689" selected="true" />
        <select idref="V-95691" selected="true" />
        <select idref="V-95693" selected="true" />
        <select idref="V-95695" selected="true" />
        <select idref="V-95697" selected="true" />
        <select idref="V-95699" selected="true" />
        <select idref="V-95701" selected="true" />
        <select idref="V-95703" selected="true" />
        <select idref="V-95705" selected="true" />
        <select idref="V-95707" selected="true" />
        <select idref="V-95709" selected="true" />
        <select idref="V-95711" selected="true" />
        <select idref="V-95713" selected="true" />
        <select idref="V-95715" selected="true" />
        <select idref="V-95719" selected="true" />
        <select idref="V-95721" selected="true" />
        <select idref="V-95723" selected="true" />
        <select idref="V-95725" selected="true" />
        <select idref="V-95727" selected="true" />
        <select idref="V-95729" selected="true" />
        <select idref="V-95731" selected="true" />
        <select idref="V-95733" selected="true" />
        <select idref="V-95735" selected="true" />
        <select idref="V-95739" selected="true" />
        <select idref="V-95741" selected="true" />
        <select idref="V-95743" selected="true" />
        <select idref="V-95745" selected="true" />
        <select idref="V-95747" selected="true" />
        <select idref="V-95749" selected="true" />
        <select idref="V-95751" selected="true" />
        <select idref="V-95753" selected="true" />
        <select idref="V-95755" selected="true" />
        <select idref="V-95757" selected="true" />
        <select idref="V-95759" selected="true" />
        <select idref="V-95761" selected="true" />
        <select idref="V-95763" selected="true" />
        <select idref="V-95765" selected="true" />
        <select idref="V-95767" selected="true" />
        <select idref="V-95769" selected="true" />
        <select idref="V-95771" selected="true" />
        <select idref="V-95773" selected="true" />
        <select idref="V-95775" selected="true" />
        <select idref="V-95777" selected="true" />
        <select idref="V-95779" selected="true" />
        <select idref="V-95781" selected="true" />
        <select idref="V-95783" selected="true" />
        <select idref="V-95785" selected="true" />
        <select idref="V-96003" selected="true" />
    </Profile>
    <Group id="V-94863">
        <title>SRG-APP-000001</title>
        <description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description>
        <Rule id="SV-104693r1_rule" severity="low" weight="10.0">
            <version>DKER-EE-001000</version>
            <title>The Docker Enterprise Per User Limit Login Session Control in the Universal Control Plane (UCP) Admin Settings must be set to an organization-defined value for all accounts and/or account types.</title>
            <description>&lt;VulnDiscussion&gt;The UCP component of Docker Enterprise includes a built-in access authorization mechanism called eNZi which can be integrated with an LDAP server and subsequently configured to limit the number of concurrent sessions to an organization-defined number for all accounts and/or account types. Per-user session control limits are configured with a default of 10. For reference, the per user limit in UCP specifies the maximum number of sessions that any user can have active at any given time. If creating a new session would put a user over this limit then the least recently used session will be deleted. A value of zero disables limiting the number of sessions that users may have. This configuration applies to both the UCP and DTR management consoles.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
            <reference>
                <dc:title>DPMS Target Docker Enterprise Edition 2.0</dc:title>
                <dc:publisher>DISA</dc:publisher>
                <dc:type>DPMS Target</dc:type>
                <dc:subject>Docker Enterprise Edition 2.0</dc:subject>
                <dc:identifier>3425</dc:identifier>
            </reference>
            <ident system="http://iase.disa.mil/cci">CCI-000054</ident>
            <fixtext fixref="F-101009r1_fix">Set the "Per User Limit" Login Session Control in the UCP Admin Settings per the requirements set forth by the System Security Plan (SSP).

              via UI:

              In the UCP web console, navigate to "Admin Settings" | "Authentication &amp; Authorization" and set the "Per User Limit" field according to the requirements of this control.

              via CLI:

              Linux (requires curl and jq): As a Docker EE Admin, execute the following commands on either a UCP Manager node or using a UCP client bundle. Replace [ucp_url] with the UCP URL, [ucp_username] with the username of a UCP administrator and [ucp_password] with the password of a UCP administrator. AUTHTOKEN=$(curl -sk -d '{"username":"[ucp_username]","password":"[ucp_password]"}' https://[ucp_url]/auth/login | jq -r .auth_token)
              curl -sk -H "Authorization: Bearer $AUTHTOKEN" https://[ucp_url]/api/ucp/config-toml &gt; ucp-config.toml

              Open the "ucp-config.toml" file, set the "per_user_limit" entry under the "[auth.sessions]" section according to the requirements of this control. Save the file.

              Execute the following commands to update UCP with the new configuration:

              curl -sk -H "Authorization: Bearer $AUTHTOKEN" --upload-file ucp-config.toml https://[ucp_url]/api/ucp/config-toml</fixtext>
            <fix id="F-101009r1_fix" />
            <check system="C-94171r1_chk">
                <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Docker_Enterprise_2-x_Linux-UNIX_STIG.xml" />
                <check-content>Check that the "Per User Limit" Login Session Control in the UCP Admin Settings is set according to the values defined in the System Security Plan.

                  via UI:

                  In the UCP web console, navigate to "Admin Settings" | "Authentication &amp; Authorization" and verify the "Per User Limit" field is set according to the number specified in the System Security Plan.

                  via CLI:

                  Linux (requires curl and jq): As a Docker EE Admin, execute the following commands from a machine with connectivity to the UCP management console. Replace [ucp_url] with the UCP URL, [ucp_username] with the username of a UCP administrator and [ucp_password] with the password of a UCP administrator. AUTHTOKEN=$(curl -sk -d '{"username":"[ucp_username]","password":"[ucp_password]"}' https://[ucp_url]/auth/login | jq -r .auth_token)
                  curl -sk -H "Authorization: Bearer $AUTHTOKEN" https://[ucp_url]/api/ucp/config-toml|grep per_user_limit

                  If the "per_user_limit" entry under the "[auth.sessions]" section in the output is not set according to the value defined in the SSP, this is a finding.</check-content>
            </check>
        </Rule>
    </Group>
    <Group id="V-94865">
        <title>SRG-APP-000014</title>
        <description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description>
        <Rule id="SV-104695r1_rule" severity="medium" weight="10.0">
            <version>DKER-EE-001050</version>
            <title>TCP socket binding for all Docker Engine - Enterprise nodes in a Universal Control Plane (UCP) cluster must be disabled.</title>
            <description>&lt;VulnDiscussion&gt;The UCP component of Docker Enterprise configures and leverages Swarm Mode for node-to-node cluster communication. Swarm Mode is built in to Docker Engine - Enterprise and uses TLS 1.2 at a minimum for encrypting communications. Under the hood, Swarm Mode includes an embedded public key infrastructure (PKI) system. When a UCP cluster is initialized, the first node in the cluster designates itself as a manager node. That node subsequently generates a new root Certificate Authority (CA) along with a key pair, which are used to secure communications with other UCP nodes that join the swarm. One can also specify his/her own externally-generated root CA upon initialization of a UCP cluster. The manager node also generates two tokens to use when joining additional nodes to the cluster: one worker token and one manager token. Each token includes the digest of the root CA’s certificate and a randomly generated secret. When a node joins the cluster, the joining node uses the digest to validate the root CA certificate from the remote manager. The remote manager uses the secret to ensure the joining node is an approved node. Each time a new node joins the cluster, the manager issues a certificate to the node. The certificate contains a randomly generated node ID to identify the node under the certificate common name (CN) and the role under the organizational unit (OU). The node ID serves as the cryptographically secure node identity for the lifetime of the node in the current swarm. In this mutual TLS architecture, all nodes encrypt communications using a minimum of TLS 1.2, thereby satisfying the requirements of this control. This information can also be referenced at https://docs.docker.com/engine/swarm/how-swarm-mode-works/pki/ and https://docs.docker.com/ee/ucp/ucp-architecture/.

              By itself, Docker Engine - Enterprise is configured by default to listen for API requests via a UNIX domain socket (or IPC socket) created at /var/run/docker.sock on supported Linux distributions and via a named pipe at npipe:////./pipe/docker_engine on Windows Server 2016 and newer. Docker Engine - Enterprise can also be configured to listen for API requests via additional socket types, including both TCP and FD (only on supported systemd-based Linux distributions). If configured to listen for API requests via the TCP socket type over TCP port 2376 and with the daemon flags and SSL certificates, then, at a minimum, TLS 1.2 is used for encryption; therefore this control is applicable and is inherently met in this configuration. If configured to listen for API requests via the TCP socket type, but without TLS verification and certifications, then the instance remains vulnerable and is not properly configured to meet the requirements of this control. If configured to listen for API requests via the FD socket type, then this control is not applicable. More information can be found at https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option. The TCP socket binding should be disabled when running Engine as part of a UCP cluster.

              Satisfies: SRG-APP-000014, SRG-APP-000141, SRG-APP-000219, SRG-APP-000383, SRG-APP-000439, SRG-APP-000440, SRG-APP-000441, SRG-APP-000442, SRG-APP-000142&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
            <reference>
                <dc:title>DPMS Target Docker Enterprise Edition 2.0</dc:title>
                <dc:publisher>DISA</dc:publisher>
                <dc:type>DPMS Target</dc:type>
                <dc:subject>Docker Enterprise Edition 2.0</dc:subject>
                <dc:identifier>3425</dc:identifier>
            </reference>
            <ident system="http://iase.disa.mil/cci">CCI-000068</ident>
            <ident system="http://iase.disa.mil/cci">CCI-000381</ident>
            <ident system="http://iase.disa.mil/cci">CCI-000382</ident>
            <ident system="http://iase.disa.mil/cci">CCI-001184</ident>
            <ident system="http://iase.disa.mil/cci">CCI-001762</ident>
            <ident system="http://iase.disa.mil/cci">CCI-002418</ident>
            <ident system="http://iase.disa.mil/cci">CCI-002420</ident>
            <ident system="http://iase.disa.mil/cci">CCI-002421</ident>
            <ident system="http://iase.disa.mil/cci">CCI-002422</ident>
            <fixtext fixref="F-101011r1_fix">This fix only applies to Docker Engine - Enterprise nodes that are part of a UCP cluster.
                Apply this fix to every node in the cluster.

                (Linux) Execute the following command to open an override file for docker.service:

                sudo systemctl edit docker.service

                Remove any "-H" host daemon flags from the "ExecStart=/usr/bin/dockerd" line in the override file.

                Save the file and reload the config with the following command:

                sudo systemctl daemon-reload

                Restart Docker with the following command:

                sudo systemctl restart docker.service</fixtext>
            <fix id="F-101011r1_fix" />
            <check system="C-94173r1_chk">
                <check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Docker_Enterprise_2-x_Linux-UNIX_STIG.xml" />
                <check-content>This check only applies to the Docker Engine - Enterprise component of Docker Enterprise.

                  via CLI:

                  Linux: Verify the daemon has not been started with the "-H TCP://[host]" argument by running the following command:

                  ps -ef | grep dockerd

                  If -H UNIX://, this is not a finding.

                  If the "-H TCP://[host]" argument appears in the output, then this is a finding.</check-content>
            </check>
        </Rule>
    </Group>
</Benchmark>